<!--page/cart/index.wxml-->
<view class="container">
  <!-- 购物车为空时显示 -->
  <view class="empty-cart" wx:if="{{!cartItems.length}}">
    <image src="/assets/icons/empty-cart.png" mode="aspectFit"></image>
    <text>购物车还是空的</text>
    <button class="go-shopping" bindtap="navigateToService">去选购</button>
  </view>

  <!-- 购物车有商品时显示 -->
  <view class="cart-content" wx:else>
    <!-- 商品列表 -->
    <view class="cart-list">
      <view class="cart-item" wx:for="{{cartItems}}" wx:key="id">
        <view class="checkbox">
          <checkbox checked="{{item.selected}}" bindtap="toggleSelect" data-id="{{item.id}}"/>
        </view>
        <image class="item-image" src="{{item.image}}" mode="aspectFill" bind:tap="queryProductDetail"></image>
        <view class="item-info">
          <view class="item-name">{{item.name}}</view>
          <view class="item-spec">{{item.specification}}</view>
          <view class="item-bottom">
            <view class="item-price">¥{{item.price}}</view>
            <view class="quantity-control">
              <text class="minus" bindtap="decreaseQuantity" data-id="{{item.id}}">-</text>
              <input type="number" value="{{item.quantity}}" bindblur="updateQuantity" data-id="{{item.id}}"/>
              <text class="plus" bindtap="increaseQuantity" data-id="{{item.id}}">+</text>
            </view>
          </view>
        </view>
        <view class="delete-btn" bindtap="deleteItem" data-id="{{item.id}}">
          <image src="/assets/icons/delete.png" mode="aspectFit"></image>
        </view>
      </view>
    </view>

    <!-- 推荐商品 -->
    <view class="recommend-section">
      <view class="section-title">猜你喜欢</view>
      <scroll-view class="recommend-scroll" scroll-x>
        <view class="recommend-item" wx:for="{{recommendItems}}" wx:key="id" bindtap="addToCart" data-id="{{item.id}}">
          <image src="{{item.image}}" mode="aspectFill"></image>
          <view class="recommend-info">
            <text class="recommend-name">{{item.name}}</text>
            <text class="recommend-price">¥{{item.price}}</text>
          </view>
        </view>
      </scroll-view>
    </view>

    <!-- 底部结算栏 -->
    <view class="settlement-bar">
      <view class="select-all">
        <checkbox checked="{{allSelected}}" bindtap="toggleSelectAll"/>
        <text>全选</text>
      </view>
      <view class="total-info">
        <view class="total-price">
          <text>合计：</text>
          <text class="price">¥{{totalPrice}}</text>
        </view>
        <text class="discount-tip">已优惠¥{{discount}}</text>
      </view>
      <button class="checkout-btn" bindtap="checkout">结算({{selectedCount}})</button>
    </view>
  </view>
</view> 